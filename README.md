# Решение задичи поиска градиентов на изображении

## Условие задачи
Предложите алгоритм, который позволит находить на изображении участки с градиентной заливкой (участки прямоугольной формы, стороны прямоугольника параллельны границам изображения).

## Как запустить
* Необходимо, чтобы был установлен python3 и модуль pip
* `./setup.sh` - установка необходимых пакетов python
* `./run.sh image out_dir`, где `image` - это путь до картинки, а `out_dir` - путь, где создать изображение

## Описание алгоритма
За основу взят оператор Собеля — дискретный дифференциальный оператор, вычисляющий приближённое значение градиента яркости изображения (он используется для рисования границ на изображениях).
С помощью опертора Собеля вычисляются изменения яркости в каждой точке.
Если численное значение большое, то в этой точке находится граница.
Градиентам же присуще небольшое изменение цвета. На этом факте и основан алгоритм.

По предположению, если в точке значение оператора Собеля больше какой-то константы, то она не может принадлежать градиенту.
Удалив все такие точки (закрасив черным), получаем файл `inter.jpg`.
После удаления лишних точек, ищутся квадраты с фиксированной стороной (в пикселях), где нет лишних точек.
Так получается файл `final.jpg`

#### P. S.
В алгоритме не учитываются изображения с кусками одного цвета (наверное, их можно отнести к градиентам, у которых цвета равны). 
Если пытаться убирать области с постоянным цветом, то они могут быть внутри какого-то большого градиента.

## Примеры работы
### Обычный градиент
#### Изначальная картинка:
![alt text](images/common_gradient/common_gradient.jpg "Изначальная картинка")

#### Картинка после удаления точек границы:
![alt text](images/common_gradient/inter.jpg "Картинка после удаления точек границы")

#### Финальная картинка:
![alt text](images/common_gradient/final.jpg "Финальная картинка")

### Закат

#### Изначальная картинка:
![alt text](images/sun/sun.jpg "Изначальная картинка")

#### Картинка после удаления точек границы:
![alt text](images/sun/inter.jpg "Картинка после удаления точек границы")

#### Финальная картинка:
![alt text](images/sun/final.jpg "Финальная картинка")

### Машина с градиентной раскраской

#### Изначальная картинка:
![alt text](images/car/car.jpg "Изначальная картинка")

#### Картинка после удаления точек границы:
![alt text](images/car/inter.jpg "Картинка после удаления точек границы")

#### Финальная картинка:
![alt text](images/car/final.jpg "Финальная картинка")

### Книга

#### Изначальная картинка:
![alt text](images/book/book.jpg "Изначальная картинка")

#### Картинка после удаления точек границы:
![alt text](images/book/inter.jpg "Картинка после удаления точек границы")

#### Финальная картинка:
![alt text](images/book/final.jpg "Финальная картинка")

## Изменение констант

В файле `config.py` есть две константы, изменив которые, можно улучшить работу алгоритма на определенных тестах.

`max_sobel_sum = 75` отвечает за максимальное значение изменения яркости. Чем ниже, тем грубее фильтр.
`square_len = 10` отвечает за размеры квадратов с хорошими клетками. Чем больше размер квадрата, тем больше областей отсекается. 

Поменяв значения на `max_sobel_sum = 40` и `square_len = 25`, получили меньше областей с градиентом.

#### Картинка после удаления точек границы:
![alt text](images/book_test/inter.jpg "Картинка после удаления точек границы")

#### Финальная картинка:
![alt text](images/book_test/final.jpg "Финальная картинка")
